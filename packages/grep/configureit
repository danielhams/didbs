#!/bin/sh

BUILDDIR=$1
INSTALLDIR=$2
EXTRAARGS=$3
echo $BUILDDIR
echo $INSTALLDIR
echo $EXTRAARGS
CC=$DIDBS_CC
CPPFLAGS="-I$INSTALLDIR/include"
#CFLAGS="$DIDBS_ARCH_CFLAGS -O1"
CFLAGS="$DIDBS_ARCH_CFLAGS -O3 -OPT:Olimit=0:space=ON -IPA -TENV:X=1 -CG:unique_exit=on -OPT:IEEE_arithmetic=1:roundoff=0:wrap_around_unsafe_opt=off -woff 1009,1014,1107,1110,1116,1164,1185,1188,1204,1230,1233 -Wl,-woff,86,-woff,84"
LDFLAGS="$DIDBS_ARCH_LDFLAGS -L$INSTALLDIR/lib"
LD_LIBRARYN32_PATH="$INSTALLDIR/lib"
PKG_CONFIG_PATH="$INSTALLDIR/lib/pkgconfig"
PERL=$INSTALLDIR/bin/perl
export CC CFLAGS LDFLAGS LD_LIBRARYN32_PATH PKG_CONFIG_PATH PERL
cd $BUILDDIR || exit -1
./configure --prefix=$INSTALLDIR --disable-silent-rules || exit -1
exit 0
