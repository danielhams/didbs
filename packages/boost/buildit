#!/bin/sh

BUILDDIR=$1
INSTALLDIR=$2
EXTRAARGS=$3
echo $BUILDDIR
echo $INSTALLDIR
echo $EXTRAARGS
CC=$DIDBS_CC
CXX=$DIDBS_CXX
CPPFLAGS="-I$INSTALLDIR/include"
CFLAGS="$DIDBS_ARCH_CFLAGS -O1"
CXXFLAGS="DIDBS_ARCH_CXXFLAGS -O1"
LDFLAGS="$DIDBS_ARCH_LDFLAGS -L$INSTALLDIR/lib"
BZIP2_INCLUDE="$INSTALLDIR/include"
BZIP2_LIBPATH="$INSTALLDIR/lib"
BJAM_CONFIG="-j $DIDBS_JOBS"
export CC CXX CPPFLAGS CFLAGS CXXFLAGS LDFLAGS BZIP2_INCLUDE BZIP2_LIBPATH BJAM_CONFIG
cd $BUILDDIR || exit -1
# For 1_53
#./bootstrap.sh --prefix=$INSTALLDIR
## List libraries with b2 --show-libraries
## Test may be executed by finding the lib test directory and running the full b2 command from inside there.
#./b2 -j $DIDBS_JOBS --link=shared --threading=multi --with-thread --with-system --with-chrono --with-program_options --prefix=$INSTALLDIR stage || exit -1

# For 1_33_1
./configure --prefix=$INSTALLDIR --without-libraries=python
make

exit 0
