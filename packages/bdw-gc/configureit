#!/bin/sh

BUILDDIR=$1
INSTALLDIR=$2
EXTRAARGS=$3
echo $BUILDDIR
echo $INSTALLDIR
echo $EXTRAARGS
. ./setupenv.sh
cd $BUILDDIR || exit -1
mkdir ../build-gc
cd ../build-gc
# dynamic loading + debug + threads
#$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --enable-gc-debug --enable-gc-assertions --with-libatomic-ops=yes --enable-dynamic-loading --enable-threads=pthreads || exit -1
# dynamic loading + debug
#$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --enable-gc-debug --enable-gc-assertions --with-libatomic-ops=yes --enable-dynamic-loading || exit -1
# no dynamic loading + debug
#$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --enable-gc-debug --enable-gc-assertions --with-libatomic-ops=yes --disable-dynamic-loading || exit -1
# dynamic loading
#$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --with-libatomic-ops=yes --enable-dynamic-loading || exit -1
# dynamic loading + threads
$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --with-libatomic-ops=yes --enable-dynamic-loading --enable-threads=pthreads || exit -1
# No debug or dynamic loading but threads
#$BUILDDIR/configure --prefix=$INSTALLDIR --with-libatomic-ops --disable-silent-rules --disable-dynamic-loading --enable-threads=pthreads || exit -1
exit 0
