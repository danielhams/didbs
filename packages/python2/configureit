#!/bin/sh

BUILDDIR=$1
INSTALLDIR=$2
EXTRAARGS=$3
echo $BUILDDIR
echo $INSTALLDIR
echo $EXTRAARGS
CC=$DIDBS_CC
CPPFLAGS="-I$INSTALLDIR/include -I$INSTALLDIR/include/ncurses"
# Python uses -O anyway, override here doesn't work
#CFLAGS="$DIDBS_ARCH_CFLAGS -O1"
#CXXFLAGS="$DIDBS_ARCH_CFLAGS -O1"
CFLAGS="$DIDBS_ARCH_CFLAGS"
CXXFLAGS="$DIDBS_ARCH_CFLAGS"
LDFLAGS="$DIDBS_ARCH_LDFLAGS -L$INSTALLDIR/lib"
PERL="$INSTALLDIR/bin/perl"
TEST_SHELL="$INSTALLDIR/bin/bash"
SHELL="$INSTALLDIR/bin/bash"
SSL="$INSTALLDIR"
export CC CPPFLAGS CFLAGS CXXFLAGS LDFLAGS PERL TEST_SHELL SHELL SSL
cd $BUILDDIR || exit -1
./configure --enable-shared --prefix=$INSTALLDIR --with-pydebug || exit -1
exit 0
