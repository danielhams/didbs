#!/bin/sh

BUILDDIR=$1
INSTALLDIR=$2
EXTRAARGS=$3
echo $BUILDDIR
echo $INSTALLDIR
echo $EXTRAARGS
CC=$DIDBS_CC
#CFLAGS="$DIDBS_ARCH_CFLAGS -O1"
CFLAGS="$DIDBS_ARCH_CFLAGS -O2"
# Seem to be more issues with O3
#CFLAGS="$DIDBS_ARCH_CFLAGS -O3 -OPT:Olimit=7000"
LDFLAGS="$DIDBS_ARCH_LDFLAGS"
export CC CFLAGS LDFLAGS
cd $BUILDDIR || exit -1
gl_cv_func_select_supports0=no gl_cv_func_select_detects_ebadf=no ./configure --prefix=$INSTALLDIR --disable-silent-rules --enable-readline --with-readline=$INSTALLDIR $EXTRAARGS || exit -1
exit 0
